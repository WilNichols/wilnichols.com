{% from "footer.njk" import footer with context %}
{% from "post-preview.njk" import postPreview with context, penPreview with context, prototypePreview with context %}

{% macro postList(collection, renderFooter = false, isGrid = false) -%}
  <ol class="posts-list{{ ' posts-list--grid' if isGrid }}" reversed>
    {% set currentDay = "" %}
    {% set currentMonth = "" %}
    {% set currentYear = "" %}
    {% for post in collection | reverse %}
      {% set postDay = post.date | postDay %}
      {% set postMonth = post.data.month %}
      {% set postYear = post.data.year %}
      {% set postPrefix %}{% if (currentDay == postDay) and (currentMonth == postMonth) %}â†³{% else %}{{ postDay }}{% endif %}{% endset %}
      {% set showAccessories %}{% for tag in post.data.tags %}{{ true if ("Type/" in tag) and not ("Type/Note" in tag)}}{% endfor %}{% endset %}
      {% if currentMonth != postMonth %}
        {% if loop.index > 1 %}</ol></li>{% endif %}
        <li class="posts-month">
          <h2 class="post__month-and-year"><span class="post__month">{{ postMonth }}</span>{% if currentYear != postYear %} <span class="post__year">{{ postYear }}</span>{% endif %}</h2>
          <ol class="posts">
      {% endif %}
      <li class="post">
        {{ postPreview(post, postPrefix, showAccessories) }}
      </li>
      {% set currentDay = postDay %}
      {% set currentMonth = postMonth %}
      {% set currentYear = postYear %}
    {% endfor %}
    {% if renderFooter %}<li class="posts-list__copyright footer">{{ footer() }}</li>{% endif %}
  </ol>
{%- endmacro %}

{% macro penList(collection) -%}
  <ol class="pen-grid" reversed>
    {% for pen in collection | reverse %}
      <li class="pen">
        {{ penPreview(pen) }}
      </li>
    {% endfor %}
  </ol>
{%- endmacro %}

{% macro protoypeList(collection) -%}
  <ol class="posts-grid" reversed>
    {% for prototype in collection | reverse %}
      <li class="prototype">
        {{ prototypePreview(prototype) }}
      </li>
    {% endfor %}
  </ol>
{%- endmacro %}
